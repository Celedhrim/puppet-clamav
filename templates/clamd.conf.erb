# Manage by puppet

LocalSocket /var/run/clamav/clamd.ctl
FixStaleSocket true
LocalSocketGroup clamav
LocalSocketMode 666
# TemporaryDirectory is not set to its default /tmp here to make overriding
# the default with environment variables TMPDIR/TMP/TEMP possible
User <%= @user %>
#AllowSupplementaryGroups false
ScanMail <%= @scan_mail %>
ScanArchive <%= @scan_archive %>
ArchiveBlockEncrypted <%= @archive_block_encrypted %>
MaxDirectoryRecursion <%= @max_dir_recursion %>
FollowDirectorySymlinks <%= @follow_dir_symlink %>
FollowFileSymlinks <%= @follow_file_symlink %>
ReadTimeout 180
MaxThreads <%= @max_threads %>
MaxConnectionQueueLength 15
LogSyslog <%= @log_syslog %>
LogRotate <%= @log_rotate %>
LogFacility <%= @log_facility %>
LogClean <%= @log_clean %>
LogVerbose <%= @verbose %>
PidFile <%= @pidfile %>
DatabaseDirectory <%= @db_dir %>
OfficialDatabaseOnly false
SelfCheck <%= @self_check_interval %>
Foreground false
Debug <%= @debug %>
ScanPE <%= @scan_pe %>
MaxEmbeddedPE 10M
ScanOLE2 true
ScanPDF true
ScanHTML true
MaxHTMLNormalize 10M
MaxHTMLNoTags 2M
MaxScriptNormalize 5M
MaxZipTypeRcg 1M
ScanSWF true
DetectBrokenExecutables false
ExitOnOOM false
LeaveTemporaryFiles <%= @keep_tmp %>
AlgorithmicDetection true
ScanELF true
IdleTimeout 30
CrossFilesystems <%= @cross_fs %>
PhishingSignatures true
PhishingScanURLs true
PhishingAlwaysBlockSSLMismatch false
PhishingAlwaysBlockCloak false
PartitionIntersection false
DetectPUA false
ScanPartialMessages false
HeuristicScanPrecedence false
StructuredDataDetection false
CommandReadTimeout 5
SendBufTimeout 200
MaxQueue 100
ExtendedDetectionInfo true
OLE2BlockMacros false
ScanOnAccess false
AllowAllMatchScan true
ForceToDisk false
DisableCertCheck false
DisableCache false
MaxScanSize 100M
MaxFileSize 25M
MaxRecursion 10
MaxFiles 10000
MaxPartitions 50
MaxIconsPE 100
StatsEnabled false
StatsPEDisabled true
StatsHostID auto
StatsTimeout 10
StreamMaxLength 25M
LogFile <%= @logfile %>
LogTime <%= @log_timestamp %>
LogFileUnlock false
LogFileMaxSize <%= @logfile_max_size %>
Bytecode <%= @bytecode %>
BytecodeSecurity TrustSigned
BytecodeTimeout 60000

